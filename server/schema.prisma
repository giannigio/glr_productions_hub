generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

/* ===========================
   MODELLO USER
   ===========================

   ATTENZIONE: questa Ã¨ una BOZZA basata sui casi tipici.
   Deve essere allineata ai campi reali della tabella "User"
   (controlla con: \d+ "User" in psql).
*/
model User {
  id        String   @id
  email     String?  @unique
  username  String?
  password  String?
  role      String?  @default("User")
  createdAt DateTime @default(now())

  // Se in futuro vuoi legare Job / CrewMember a User puoi aggiungere relazioni qui.
}

/* ===========================
   JOB
   (da ai_studio_code.sql)
   =========================== */

model Job {
  id               String   @id
  title            String
  client           String
  location         String
  locationId       String?
  startDate        String
  endDate          String
  status           String
  description      String
  departments      String[]
  isAwayJob        Boolean  @default(false)
  isSubcontracted  Boolean  @default(false)
  subcontractorName String?
  outfit           String?
  outfitNoLogo     Boolean  @default(false)
  phases           Json
  vehicles         Json
  materialList     Json
  assignedCrew     String[]
  notes            String
  createdAt        DateTime @default(now())
  updatedAt        DateTime

  @@map("Job")
}

/* ===========================
   CREWMEMBER
   =========================== */

model CrewMember {
  id                  String   @id
  name                String
  type                String
  roles               String[]
  dailyRate           Float
  overtimeRate        Float?
  travelIndemnity     Float?
  email               String?  @unique
  password            String?
  accessRole          String?
  phone               String
  absences            Json
  expenses            Json
  tasks               Json
  documents           Json
  financialDocuments  Json

  @@map("CrewMember")
}

/* ===========================
   LOCATION
   =========================== */

model Location {
  id                 String   @id
  name               String
  address            String
  hallSizeMQ         Int      @default(0)
  mapsLink           String
  isZtl              Boolean
  contactName        String
  contactPhone       String
  accessHours        String
  power              Json
  network            Json
  logistics          Json
  equipment          Json
  generalSurveyNotes String

  @@map("Location")
}

/* ===========================
   INVENTORY ITEM
   =========================== */

model InventoryItem {
  id             String  @id
  name           String
  category       String
  type           String?
  quantityOwned  Int
  weightKg       Float?
  serialNumber   String? @unique
  status         String?
  accessories    String?
  notes          String?

  @@map("InventoryItem")
}

/* ===========================
   APP SETTINGS
   =========================== */

model AppSettings {
  id       Int   @id @default(autoincrement())
  settings Json

  @@map("AppSettings")
}
