// This is your Prisma schema file.
// It defines the models for your database.

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Model for Authentication
model User {
  id           String      @id @default(uuid())
  email        String      @unique
  password     String
  role         String // ADMIN, MANAGER, TECH
  createdAt    DateTime    @default(now())
  crewMemberId String      @unique
  crewMember   CrewMember  @relation(fields: [crewMemberId], references: [id])
}

// Model for Crew Data
model CrewMember {
  id                 String     @id @default(uuid())
  name               String
  type               String // Interno | Esterno
  roles              String[]
  phone              String
  dailyRate          Float
  overtimeRate       Float?
  travelIndemnity    Float?
  absences           Json       @default("[]")
  expenses           Json       @default("[]")
  tasks              Json       @default("[]")
  documents          Json       @default("[]")
  financialDocuments Json       @default("[]")
  user               User?
}

// Model for Jobs
model Job {
  id                String    @id @default(uuid())
  title             String
  client            String
  location          String
  locationId        String?
  startDate         String
  endDate           String
  status            String
  description       String
  departments       String[]
  isAwayJob         Boolean   @default(false)
  isSubcontracted   Boolean   @default(false)
  subcontractorName String?
  outfit            String?
  outfitNoLogo      Boolean   @default(false)
  phases            Json      @default("[]")
  vehicles          Json      @default("[]")
  materialList      Json      @default("[]")
  assignedCrew      String[]
  notes             String
  createdAt         DateTime  @default(now())
  updatedAt         DateTime  @updatedAt
}

// Model for Locations
model Location {
  id                 String  @id @default(uuid())
  name               String
  address            String
  hallSizeMQ         Int     @default(0)
  mapsLink           String
  isZtl              Boolean
  contactName        String
  contactPhone       String
  accessHours        String
  power              Json
  network            Json
  logistics          Json
  equipment          Json
  generalSurveyNotes String
}

// Model for Inventory
model InventoryItem {
  id            String  @id @default(uuid())
  name          String
  category      String
  type          String?
  quantityOwned Int
  weightKg      Float?
  serialNumber  String? @unique
  status        String?
  accessories   String?
  notes         String?
}

// Model for Global App Settings
model AppSettings {
  id       Int  @id @default(1)
  settings Json
}
